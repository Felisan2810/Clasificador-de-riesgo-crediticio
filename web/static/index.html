<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema H√≠brido de Riesgo Crediticio</title>
    <link rel="stylesheet" href="/static/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1 class="logo">üß† Sistema de Riesgo Crediticio</h1>
                <div class="header-status">
                    <span id="model-status" class="status-badge">Cargando...</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">
        <!-- Tabs Navigation -->
        <div class="tabs">
            <button class="tab-btn active" data-tab="predictor">
                üìä Evaluaci√≥n
            </button>
            <button class="tab-btn" data-tab="comparacion">
                üî¨ Comparaci√≥n
            </button>
            <button class="tab-btn" data-tab="analytics">
                üìà Estad√≠sticas
            </button>
            <button class="tab-btn" data-tab="modelo">
                ‚öôÔ∏è Modelo
            </button>
        </div>

        <!-- Tab: Predictor -->
        <div id="predictor" class="tab-content active">
            <div class="card">
                <h2 class="card-title">Nueva Evaluaci√≥n de Riesgo</h2>
                
                <div class="form-actions">
                    <button id="load-example" class="btn btn-secondary">
                        Cargar Ejemplo
                    </button>
                    <button id="clear-form" class="btn btn-secondary">
                        Limpiar
                    </button>
                </div>

                <form id="prediction-form" class="form">
                    <!-- Informaci√≥n del Cr√©dito -->
                    <div class="form-section">
                        <h3 class="section-title">üí∞ Informaci√≥n del Cr√©dito</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Monto Solicitado (S/.)</label>
                                <input type="number" name="monto" required min="0" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Plazo (meses)</label>
                                <input type="number" name="PlazoReal" required min="1" max="360">
                            </div>
                            <div class="form-group">
                                <label>Tasa Efectiva Anual (%)</label>
                                <input type="number" name="TasaEfectiva" required min="0" step="0.01">
                            </div>
                        </div>
                    </div>

                    <!-- Informaci√≥n del Cliente -->
                    <div class="form-section">
                        <h3 class="section-title">üë§ Informaci√≥n del Cliente</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Edad</label>
                                <input type="number" name="EdadDesembolsoNormalizada" required min="18" max="100">
                            </div>
                            <div class="form-group">
                                <label>Ingreso Mensual (S/.)</label>
                                <input type="number" name="SalarioNormalizado" required min="0" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Dependientes</label>
                                <input type="number" name="Dependientes" required min="0">
                            </div>
                            <div class="form-group">
                                <label>Nivel de Instrucci√≥n</label>
                                <select name="NivelInstruccion" required>
                                    <option value="1">Sin Instrucci√≥n</option>
                                    <option value="2">Primaria Completa</option>
                                    <option value="3">Secundaria Incompleta</option>
                                    <option value="4" selected>Secundaria Completa</option>
                                    <option value="5">Superior T√©cnica Incompleta</option>
                                    <option value="6">Superior T√©cnica Completa</option>
                                    <option value="7">Universitaria Incompleta</option>
                                    <option value="8">Universitaria Completa</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Estado Civil</label>
                                <select name="EstadoCivil" required>
                                    <option value="SOLTERO">Soltero</option>
                                    <option value="CASADO">Casado</option>
                                    <option value="DIVORCIADO">Divorciado</option>
                                    <option value="VIUDO">Viudo</option>
                                    <option value="CONVIVIENTE">Conviviente</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Sexo</label>
                                <select name="Sexo" required>
                                    <option value="1">Masculino</option>
                                    <option value="2">Femenino</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Historial Financiero -->
                    <div class="form-section">
                        <h3 class="section-title">üìã Historial Financiero</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Antig√ºedad Bancaria (meses)</label>
                                <input type="number" name="iAntiguedadBancarizado" required min="0">
                            </div>
                            <div class="form-group">
                                <label>Deuda M√°xima Anterior (S/.)</label>
                                <input type="number" name="MaxMontoInterno" required min="0" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Score Crediticio (0-1000)</label>
                                <input type="number" name="ScoreOriginacionMicro" required min="0" max="1000">
                            </div>
                            <div class="form-group">
                                <label>Score Sobreendeudamiento (0-1000)</label>
                                <input type="number" name="Score_Sobreendeudamiento" required min="0" max="1000">
                            </div>
                        </div>
                    </div>

                    <!-- Balance Financiero -->
                    <div class="form-section">
                        <h3 class="section-title">üíº Balance Financiero</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Total Activos (S/.)</label>
                                <input type="number" name="Bal_TotalActivosNormalizado" required min="0" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Ingresos del Negocio (S/.)</label>
                                <input type="number" name="NetoIngresosNegocioNormalizado" required min="0" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Liquidez Disponible (S/.)</label>
                                <input type="number" name="LiquidezDisponibleNormalizado" required min="0" step="0.01">
                            </div>
                        </div>
                    </div>

                    <!-- Informaci√≥n Adicional -->
                    <div class="form-section">
                        <h3 class="section-title">‚ÑπÔ∏è Informaci√≥n Adicional</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Segmento de Cartera</label>
                                <select name="SegmentoCartera" required>
                                    <option value="1">Segmento 1 - Premium</option>
                                    <option value="2">Segmento 2 - Alto</option>
                                    <option value="3">Segmento 3 - Medio</option>
                                    <option value="4">Segmento 4 - B√°sico</option>
                                    <option value="5">Segmento 5 - Inicial</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Apoyo Gubernamental</label>
                                <select name="apoyogobierno" required>
                                    <option value="0">No</option>
                                    <option value="1">S√≠</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Intensidad COVID (0-1)</label>
                                <input type="number" name="covid_intensity" value="0.3" min="0" max="1" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Anomal√≠a Temperatura</label>
                                <input type="number" name="temperatura_anomalia" value="0" min="-3" max="3" step="0.1">
                            </div>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary btn-large">
                        üöÄ Evaluar Riesgo
                    </button>
                </form>
            </div>

            <!-- Resultados -->
            <div id="results" class="card" style="display: none;">
                <h2 class="card-title">Resultado de Evaluaci√≥n</h2>
                
                <div id="result-content"></div>
                
                <div class="result-actions">
                    <button id="download-report" class="btn btn-secondary">
                        üìÑ Descargar Reporte
                    </button>
                    <button id="register-feedback" class="btn btn-secondary">
                        üìù Registrar Feedback
                    </button>
                    <button id="new-evaluation" class="btn btn-primary">
                        üîÑ Nueva Evaluaci√≥n
                    </button>
                </div>
            </div>
        </div>

        <!-- Tab: Comparaci√≥n -->
        <div id="comparacion" class="tab-content">
            <div class="card">
                <h2 class="card-title">üî¨ Comparaci√≥n: Con vs Sin L√≥gica Difusa</h2>
                <p class="card-description">
                    Compare los resultados de predicci√≥n utilizando el sistema h√≠brido completo vs solo Machine Learning
                </p>

                <button id="compare-btn" class="btn btn-primary btn-large">
                    Ejecutar Comparaci√≥n
                </button>

                <div id="comparison-results" style="display: none;">
                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h3>üß† Sistema H√≠brido (Difuso + ML)</h3>
                            <div id="hybrid-result"></div>
                        </div>
                        <div class="comparison-card">
                            <h3>ü§ñ Solo Machine Learning</h3>
                            <div id="ml-only-result"></div>
                        </div>
                        <div class="comparison-card">
                            <h3>üéØ Solo L√≥gica Difusa</h3>
                            <div id="fuzzy-only-result"></div>
                        </div>
                    </div>

                    <div id="comparison-chart"></div>
                </div>
            </div>
        </div>

        <!-- Tab: Analytics -->
        <div id="analytics" class="tab-content">
            <div class="card">
                <h2 class="card-title">üìà Estad√≠sticas y Feedback</h2>
                
                <button id="refresh-stats" class="btn btn-secondary">
                    üîÑ Actualizar Estad√≠sticas
                </button>

                <div id="stats-content">
                    <p class="loading-text">Cargando estad√≠sticas...</p>
                </div>

                <div id="stats-charts"></div>
            </div>
        </div>

        <!-- Tab: Modelo -->
        <div id="modelo" class="tab-content">
            <div class="card">
                <h2 class="card-title">‚öôÔ∏è Gesti√≥n del Modelo</h2>
                
                <div class="model-info">
                    <h3>Estado Actual</h3>
                    <div id="model-info-content">
                        <p class="loading-text">Cargando informaci√≥n del modelo...</p>
                    </div>
                </div>

                <div class="model-actions">
                    <div class="action-card">
                        <h3>üéì Entrenar Modelo</h3>
                        <p>Entrenar un nuevo modelo con los datos disponibles</p>
                        <button id="train-model" class="btn btn-primary">
                            Entrenar
                        </button>
                    </div>

                    <div class="action-card">
                        <h3>üóëÔ∏è Eliminar Modelo</h3>
                        <p>Eliminar el modelo actual (requiere reentrenamiento)</p>
                        <button id="delete-model" class="btn btn-danger">
                            Eliminar
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="spinner"></div>
        <p id="loading-text">Procesando...</p>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>

    <script src="/static/app.js"></script>
</body>
</html>